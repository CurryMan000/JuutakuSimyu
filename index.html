<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>住宅購入シミュレーター</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  margin: 0;
  padding: 20px;
  background: #f4f6f9;
  color: #333;
}

h1 {
  text-align: center;
  font-size: 22px;
  margin-bottom: 20px;
}

.card {
  background: #ffffff;
  padding: 18px;
  border-radius: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  margin-bottom: 20px;
}

.label {
  font-size: 14px;
  margin-bottom: 5px;
  color: #666;
}

input, select {
  width: 100%;
  padding: 10px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ddd;
  margin-bottom: 15px;
}

button {
  width: 100%;
  padding: 15px;
  font-size: 18px;
  font-weight: bold;
  background: #1f3c88;
  color: white;
  border: none;
  border-radius: 12px;
  cursor: pointer;
}

.result-title {
  font-size: 14px;
  color: #777;
}

.result-main {
  font-size: 34px;
  font-weight: bold;
  margin: 10px 0;
}

.sub-result {
  margin: 6px 0;
  font-size: 15px;
}

.red { color: #d64545; font-weight: bold; }
.green { color: #2d9c5f; font-weight: bold; }
</style>
</head>

<body>

<h1>住宅ローンシミュレーター</h1>

<div class="card">
  <div class="label">希望物件価格（任意）</div>
  <input type="number" id="propertyPrice" placeholder="例：4200">

  <div class="label">月返済額</div>
  <input type="number" id="monthly" value="9">

  <div class="label">ボーナス返済（1回）</div>
  <input type="number" id="bonus" value="0">

  <div class="label">固定金利（％）</div>
  <input type="number" step="0.1" id="rate" value="1.0">

  <div class="label">ローン年数</div>
  <select id="years">
    <option value="35">35年</option>
    <option value="40">40年</option>
  </select>

  <div class="label">諸費用率</div>
  <input type="number" step="0.01" id="feeRate" value="0.07">

  <div class="label">用意できる頭金</div>
  <input type="number" id="downPayment" value="200">
</div>

<button onclick="calculate()">計算する</button>

<div class="card" id="result"></div>

<script>
function calculate() {
  const propertyPrice = parseFloat(document.getElementById("propertyPrice").value) * 10000 || 0;
  const monthly = parseFloat(document.getElementById("monthly").value) * 10000;
  const bonus = parseFloat(document.getElementById("bonus").value) * 10000;
  const rate = parseFloat(document.getElementById("rate").value);
  const years = parseInt(document.getElementById("years").value);
  const feeRate = parseFloat(document.getElementById("feeRate").value);
  const downPayment = parseFloat(document.getElementById("downPayment").value) * 10000;

  const r = rate / 100 / 12;
  const n = years * 12;
  const monthlyTotal = monthly + (bonus * 2) / 12;
  const loanAmount = monthlyTotal * (1 - Math.pow(1 + r, -n)) / r;
  const maxPropertyPrice = (loanAmount + downPayment) / (1 + feeRate);

  let html = "";

  const toMan = (yen) => Math.round(yen / 10000).toLocaleString();

  if (!propertyPrice) {
    html += `<div class="result-title">最大物件価格</div>`;
    html += `<div class="result-main">${toMan(maxPropertyPrice)} 万円</div>`;
    html += `<div class="sub-result">借入可能額：${toMan(loanAmount)} 万円</div>`;
    html += `<div class="sub-result">必要現金：${toMan(downPayment + maxPropertyPrice * feeRate)} 万円</div>`;
  } else {
    const totalNeeded = propertyPrice * (1 + feeRate);
    const totalAvailable = loanAmount + downPayment;
    const difference = totalNeeded - totalAvailable;

    html += `<div class="result-title">希望物件価格</div>`;
    html += `<div class="result-main">${toMan(propertyPrice)} 万円</div>`;
    html += `<div class="sub-result">借入可能額：${toMan(loanAmount)} 万円</div>`;
    html += `<div class="sub-result">必要現金：${toMan(propertyPrice * feeRate + downPayment)} 万円</div>`;

    if (difference > 0) {
      html += `<div class="sub-result red">不足金額：${toMan(difference)} 万円</div>`;
    } else {
      html += `<div class="sub-result green">余裕あり：${toMan(Math.abs(difference))} 万円</div>`;
    }
  }

  document.getElementById("result").innerHTML = html;
}
</script>

</body>
</html>
